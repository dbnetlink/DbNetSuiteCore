@page
@using DbNetSuiteCore.Components;
@using DbNetSuiteCore.Enums.DbNetEdit;
@using DbNetSuiteCore.Enums;
@{
    DbNetEditCore employeesEdit = new DbNetEditCore("northwind", "employees");
    employeesEdit.SetColumnLookup("ReportsTo", new Lookup("employees", "employeeid", "lastname + ', ' + firstname"));
    employeesEdit.SetControlType("notes", EditControlType.TextArea);
    employeesEdit.SetColumnPattern("titleofcourtesy", "Mr.|Dr.|Ms.|Mr.");
    employeesEdit.Bind(EventType.OnFormElementCreated, "configureFormElement");
    employeesEdit.SetColumnBrowse(new string[] { "lastname", "firstname", "titleofcourtesy" });
    employeesEdit.SetColumnRequired(new string[] { "lastname", "firstname", "titleofcourtesy" });
    employeesEdit.SetColumnAsImage("Photo", new ImageConfiguration("jpg"));
    employeesEdit.Bind(EventType.OnConfigureBinaryData, "configureImageFileName");

    employeesEdit.Insert = true;
    employeesEdit.Delete = true;
    @employeesEdit.Render()
}

<script>
    function configureFormElement(sender, args)
    {
        if (args.columnName == "notes")
        {
            args.formElement.rows = 4;
            args.formElement.cols = 50;
        }
    }

    function configureImageFileName(sender, args) {
        var fileName = sender.columnValue("photopath");
        args.fileName = fileName.split('/').pop().replace(".bmp",".jpg");
    }
</script>