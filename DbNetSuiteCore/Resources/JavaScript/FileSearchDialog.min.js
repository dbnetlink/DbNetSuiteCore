"use strict";class FileSearchDialog extends Dialog{constructor(n,t){var i,r,u,f,e,o,s,h;super(n);this.inputBuffer={};(i=this.$dialog)===null||i===void 0?void 0:i.on("dialogopen",n=>this.dialogOpened(n));this.parent=t;(r=this.$dialog)===null||r===void 0?void 0:r.find("select.search-operator").on("change",n=>this.configureForOperator(n));(u=this.$dialog)===null||u===void 0?void 0:u.find("[button-type='calendar']").on("click",n=>this.selectDate(n));(f=this.$dialog)===null||f===void 0?void 0:f.find("input").get().forEach(n=>{const t=$(n);t.width(300);t.on("keyup",n=>this.criteriaEntered(n.target));if(t.attr("numeric"))t.on("keypress",n=>this.filterNumericKeyPress(n))});(e=this.$dialog)===null||e===void 0?void 0:e.find("input[datatype='DateTime']").get().forEach(n=>{const t=$(n);this.addDatePicker(t,this.parent.datePickerOptions)});(o=this.$dialog)===null||o===void 0?void 0:o.find("[button-type='clear']").on("click",()=>this.clear());(s=this.$dialog)===null||s===void 0?void 0:s.find("[button-type='apply']").on("click",()=>this.apply());(h=this.$dialog)===null||h===void 0?void 0:h.find("[button-type='cancel']").on("click",()=>this.close())}dialogOpened(){var n,t;const i=((n=this.$dialog)===null||n===void 0?void 0:n.find("table").first().width())+20;(t=this.$dialog)===null||t===void 0?void 0:t.dialog("option","width",i)}configureForOperator(n){const i=$(n.target),t=i.closest("tr");switch(i.val()){case"Between":case"NotBetween":t.find(".between").show();t.find("input").show().width(102);break;case"IsNull":case"IsNotNull":t.find(".between").hide();t.find("input").hide();break;default:t.find(".between").hide();t.find("input").show().width(300)}}filterNumericKeyPress(n){const t=String.fromCharCode(n.which);if(!t.match(/[0-9,.]/)){window.clearTimeout(this.timerId);const i=$(n.currentTarget).attr("columnIndex");return this.timerId=window.setTimeout(()=>{this.checkInputBuffer(i)},500),this.inputBuffer[i]==null?this.inputBuffer[i]=t:this.inputBuffer[i]+=t,!1}}checkInputBuffer(n){var i;if(this.inputBuffer[n]!=null){let t=null;switch(this.inputBuffer[n]){case">":t="GreaterThan";break;case"<":t="LessThan";break;case"<=":t="NotGreaterThan";break;case">=":t="NotLessThan";break;case"<>":case"!=":t="NotEqualTo"}if(t){const r=(i=this.$dialog)===null||i===void 0?void 0:i.find(`[name='searchOperator(${n})']`);r.val(t)}this.inputBuffer={}}}criteriaEntered(n){const t=$(n);t.removeClass("highlight");const r=t.closest("tr").parent().closest("tr"),i=r.find("select");t.val()==""?i.val(""):i.val()==""&&i.prop("selectedIndex",1)}selectDate(n){const t=$(n.target);t.parent().find("input").datepicker("show")}clear(){var n,t;(n=this.$dialog)===null||n===void 0?void 0:n.find(".content").find("input").get().forEach(n=>{const t=$(n);t.val("");t.removeClass("highlight")});(t=this.$dialog)===null||t===void 0?void 0:t.find(".content").find("select").get().forEach(n=>{const t=$(n);t.val("")})}apply(){var n;this.parent.searchParams=[];(n=this.$dialog)===null||n===void 0?void 0:n.find(".content").find("select").get().forEach(n=>{const r=$(n),t=r.closest("tr"),i=t.find("input:eq(0)"),f=t.find("input:eq(1)"),u=t.find("select:eq(0)"),e=t.find("select:eq(1)");if(r.val()!=""&&(i.is(":visible")==!1||i.val()!="")){const n={searchOperator:r.val(),columnType:i.data("type"),value1:i.val(),value2:f.val()};u.length&&(n.unit1=u.val(),n.unit2=e.val());this.parent.searchParams.push(n)}});const t=this.parent;t.currentPage=1;t.getPage(n=>this.getPageCallback(n))}getPageCallback(n){n.searchParams&&(n.searchParams.forEach(n=>{var u;const t=(u=this.$dialog)===null||u===void 0?void 0:u.find(`tr[columntype='${n.columnType}']`),i=t===null||t===void 0?void 0:t.find("input:nth-of-type(1)"),r=t===null||t===void 0?void 0:t.find("input:nth-of-type(2)");i===null||i===void 0?void 0:i.removeClass("highlight");r===null||r===void 0?void 0:r.removeClass("highlight");n.value1Valid==!1&&(i===null||i===void 0?void 0:i.addClass("highlight"));n.value2Valid==!1&&(r===null||r===void 0?void 0:r.addClass("highlight"))}),n.message&&this.message(n.message))}}