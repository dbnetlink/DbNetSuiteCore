"use strict";class SearchDialog extends Dialog{constructor(n,t){super(n);this.$dialog.on("dialogopen",n=>this.dialogOpened(n));this.parent=t;this.$dialog.find("select.search-operator").on("change",n=>this.configureForOperator(n));this.$dialog.find("[button-type='calendar']").on("click",n=>this.selectDate(n));this.$dialog.find("[button-type='clock']").on("click",n=>this.selectTime(n));this.$dialog.find("[button-type='lookup']").on("click",n=>this.lookup(n));this.$dialog.find("input").get().forEach(n=>{var t=$(n);t.width(240);t.on("keyup",n=>this.criteriaEntered(n.target))});this.$dialog.find("input[datatype='DateTime'").get().forEach(n=>{var t=$(n);this.addDatePicker(t)});this.$dialog.find("input[datatype='TimeSpan'").get().forEach(n=>{var t=$(n);this.addTimePicker(t)});this.$dialog.find("[button-type='clear']").on("click",()=>this.clear());this.$dialog.find("[button-type='apply']").on("click",()=>this.apply());this.$dialog.find("[button-type='cancel']").on("click",()=>this.close())}dialogOpened(){var n=this.$dialog.find("table").first().height();n>400&&this.$dialog.find("div.content").height(400)}configureForOperator(n){var i=$(n.target),t=i.closest("tr");switch(i.val()){case"Between":case"NotBetween":t.find(".between").show();t.find("input").width(102);break;default:t.find(".between").hide();t.find("input").width(240)}}pickerSelected(){var t=$(this).closest("tr").parent().closest("tr"),n=t.find("select");n.val()==""&&n.prop("selectedIndex",1)}criteriaEntered(n){var i=$(n),r,t;i.removeClass("highlight");r=i.closest("tr").parent().closest("tr");t=r.find("select");i.val()==""?t.val(""):t.val()==""&&t.prop("selectedIndex",1)}selectDate(n){var t=$(n.target);t.parent().find("input").datepicker("show")}lookup(n){var t=$(n.target),i=t.parent().find("input");this.parent.lookup(i)}selectTime(n){var t=$(n.target);t.parent().find("input").timepicker("open");n.stopPropagation()}clear(){this.$dialog.find(".content").find("input").get().forEach(n=>{var t=$(n);t.val("");t.removeClass("highlight")});this.$dialog.find(".content").find("select").get().forEach(n=>{var t=$(n);t.val("")})}apply(){this.parent.searchParams=[];this.$dialog.find(".content").find("select").get().forEach(n=>{var t=$(n),i=t.closest("tr"),r=i.find("input:eq(0)"),u=i.find("input:eq(1)");if(t.val()!=""){let n={searchOperator:t.val(),columnIndex:r.attr("columnIndex"),value1:r.val(),value2:u.val()};this.parent.searchParams.push(n)}});this.parent.clearColumnFilters();this.parent.searchFilterJoin=this.$dialog.find("#searchFilterJoin").val();this.parent.getPage(n=>this.getPageCallback(n))}getPageCallback(n){n.searchParams&&(n.searchParams.forEach(n=>{var t=this.$dialog.find(`tr[columnIndex='${n.columnIndex}']`),i=t.find("input:nth-of-type(1)"),r=t.find("input:nth-of-type(2)");n.value1Valid==!1&&i.addClass("highlight");n.value2Valid==!1&&r.addClass("highlight")}),n.message&&this.message(n.message))}addDatePicker(n){var r,f;let i=this.parent.datePickerOptions;r={D:"DD, MM dd, yy",DDDD:"DD",DDD:"D",MMMM:"MM",MMM:"M",M:"m",MM:"mm",yyyy:"yy"};let t=n.attr("format"),u;for(u in r)f=new RegExp(`\\b${u}\\b`),t=t.replace(f,r[u]);t!=undefined&&t!=n.attr("format")&&(i.dateFormat=t);i.onSelect=this.pickerSelected;n.datepicker(i)}addTimePicker(n){var t={zindex:1e5};t.change=this.pickerSelected;n.timepicker(t)}}