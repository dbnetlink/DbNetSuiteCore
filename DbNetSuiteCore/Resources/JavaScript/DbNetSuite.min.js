"use strict";class DbNetSuite{constructor(n){if((this.datePickerOptions={},this.element=undefined,this.eventHandlers={},this.internalEventHandlers={},this.id="",this.connectionString="",this.connectionType="SqlServer",this.culture="",this.linkedControls=[],this.parentControlType="",this.parentChildRelationship=null,this.initialised=!1,n!=null)&&(this.id=n,this.element=$(`#${this.id}`),this.element.addClass("dbnetsuite").addClass("cleanslate").addClass("empty"),this.checkStyleSheetLoaded(),this.element.length==0)){this.error(`${this.constructor.name} container element '${this.id}' not found`);return}}bind(n,t){this.eventHandlers[n]||(this.eventHandlers[n]=[]);this.eventHandlers[n].push(t)}internalBind(n,t){this.internalEventHandlers[n]||(this.internalEventHandlers[n]=[]);this.internalEventHandlers[n].push({sender:this,method:t})}unbind(n,t){this.eventHandlers[n]!=null&&this.eventHandlers[n].forEach(n=>{n==t&&(n=function(){return})})}checkStyleSheetLoaded(){var n;let t=!1;for(const i of document.styleSheets)i.href&&((n=i===null||i===void 0?void 0:i.href)===null||n===void 0?void 0:n.indexOf("resource.dbnetsuite?action=css"))>0&&(t=!0);t||(alert("DbNetSuite stylesheet not found. Add @DbNetSuiteCore.StyleSheet() to your Razor page. See console for details."),console.error("DbNetSuite stylesheet not found. See https://dbnetsuitecore.z35.web.core.windows.net/index.htm?context=20#DbNetSuiteCoreStyleSheet"))}addLinkedControl(n){this.linkedControls.push(n)}fireEvent(n,t=undefined){if(this.eventHandlers[n]){const i=this.eventHandlers[n];i.forEach(n=>{let i=[this];t&&(i=i.concat([t]));n.apply(window,i)})}if(this.internalEventHandlers[n]){const i=this.internalEventHandlers[n];i.forEach(n=>{let i=[this];t&&(i=i.concat([t]));n.method.apply(n.context,i)})}}addPanel(n,t=undefined){const i=`${this.id}_${n}Panel`;return t==null&&(t=this.element),jQuery("<div>",{id:i}).addClass(`${this.constructor.name.toLowerCase()}-${n}`).appendTo(t),$(`#${i}`)}addLoadingPanel(){this.loadingPanel=this.addPanel("loading");this.addPanel("loadingIcon",this.loadingPanel);this.loadingPanel.addClass("dbnetsuite-loading");this.loadingPanel.children().first().addClass("icon")}showLoader(){var n;(n=this.loadingPanel)===null||n===void 0?void 0:n.addClass("display")}hideLoader(){var n,t;(n=this.element)===null||n===void 0?void 0:n.removeClass("empty");(t=this.loadingPanel)===null||t===void 0?void 0:t.removeClass("display")}post(n,t,i=false,r=null){this.showLoader();const u={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(t)};return r==null&&(r=this.constructor.name.toLowerCase()),fetch(`~/${r}.dbnetsuite?action=${n}`,u).then(n=>{if(this.hideLoader(),!n.ok)throw n;return i?n.blob():n.json()}).catch(n=>(n.text().then(n=>{console.error(n),this.error(n.split("\n").shift())}),Promise.reject()))}controlElement(n){return $(`#${this.controlElementId(n)}`)}controlElementId(n){return`${this.id}_${n}`}disable(n,t){this.controlElement(n).prop("disabled",t)}setInputElement(n,t){const i=this.controlElement(n);i.val(t.toString());i.width(`${t.toString().length}em`)}configureLinkedControls(n,t=null,i=null){this.linkedControls.forEach(r=>{this._configureLinkedControl(r,n,t,i)})}info(n,t){this.showMessageBox(MessageBoxType.Info,n,t)}confirm(n,t,i){this.showMessageBox(MessageBoxType.Confirm,n,t,i)}error(n,t=null){this.showMessageBox(MessageBoxType.Error,n,t)}showMessageBox(n,t,i=null,r=undefined){var u;this.messageBox==undefined&&this.post("message-box",this._getRequest(),!1,"dbnetsuite").then(u=>{var f,e;(f=this.element)===null||f===void 0?void 0:f.append(u.html);this.messageBox=new MessageBox(`${this.id}_message_box`);(e=this.messageBox)===null||e===void 0?void 0:e.show(n,t,i,r)});(u=this.messageBox)===null||u===void 0?void 0:u.show(n,t,i,r)}addDatePicker(n,t){const r=t,f={D:"DD, MM dd, yy",DDDD:"DD",DDD:"D",MMMM:"MM",MMM:"M",M:"m",MM:"mm",yyyy:"yy"};let i=n.attr("format"),u;for(u in f){const n=new RegExp(`\\b${u}\\b`);i=i.replace(n,f[u])}i!=undefined&&i!=n.attr("format")&&(r.dateFormat=i);r.onSelect=this.pickerSelected;n.datepicker(r)}pickerSelected(){const t=$(this).closest("tr").parent().closest("tr"),n=t.find("select");n.val()==""&&n.prop("selectedIndex",1)}addTimePicker(n){const t={zindex:1e5};t.change=this.pickerSelected;n.timepicker(t)}_configureLinkedControl(n,t,i,r){this instanceof DbNetGrid&&this.configureLinkedControl(n,t,i,r);this instanceof DbNetCombo&&this.configureLinkedControl(n,t,i);this instanceof DbNetEdit&&this.configureLinkedControl(n,i)}_getRequest(){return{componentId:this.id,connectionString:this.connectionString,culture:this.culture,parentControlType:this.parentControlType}}}DbNetSuite.DBNull="DBNull";document.addEventListener("DOMContentLoaded",function(){$.fn.button&&$.fn.button.noConflict!==undefined&&($.fn.bootstrapBtn=$.fn.button.noConflict())});