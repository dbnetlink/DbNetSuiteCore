"use strict";class DbNetCombo extends DbNetSuite{constructor(n){super();this.addEmptyOption=!1;this.addFilter=!1;this.currentValue="";this.emptyOptionText="";this.linkedControls=[];this.sql="";this.params={};this.filterDelay=1e3;this.filterMinChars=3;this.filterToken="";this.id=n;this.element=$(`#${this.id}`);this.element.addClass("dbnetsuite").addClass("cleanslate");this.checkStyleSheetLoaded();this.element.length==0}initialize(){this.callServer("page");this.initialised=!0;this.fireEvent("onInitialized")}addLinkedControl(n){this.linkedControls.push(n)}reload(){this.callServer("page")}configureCombo(n){var r,u,f;n.select&&((r=this.element)===null||r===void 0?void 0:r.html(n.select));const t=(u=this.element)===null||u===void 0?void 0:u.find("select");t===null||t===void 0?void 0:t.html(n.options);const e=t===null||t===void 0?void 0:t.width(),i=(f=this.element)===null||f===void 0?void 0:f.find("input");i===null||i===void 0?void 0:i.width(e-4);i===null||i===void 0?void 0:i.on("keyup",n=>this.filterKeyPress(n))}filterKeyPress(n){const t=n.target;window.clearTimeout(this.filterTimerId);(t.value.length>=this.filterMinChars||t.value.length==0||n.key=="Enter")&&(this.filterTimerId=window.setTimeout(()=>{this.applyFilter(t.value)},this.filterDelay))}applyFilter(n){this.filterToken=n;this.callServer("filter")}callServer(n){this.post(n,this.getRequest()).then(n=>{n.error==!1&&this.configureCombo(n)})}getRequest(){return{componentId:this.id,connectionString:this.connectionString,sql:this.sql,params:this.params,addEmptyOption:this.addEmptyOption,emptyOptionText:this.emptyOptionText,addFilter:this.addFilter,filterToken:this.filterToken}}post(n,t){this.showLoader();const i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(t)};return fetch(`~/dbnetcombo.dbnetsuite?action=${n}`,i).then(n=>{if(this.hideLoader(),!n.ok)throw n;return n.json()}).catch(n=>(n.text().then(n=>{console.error(n)}),Promise.reject()))}}